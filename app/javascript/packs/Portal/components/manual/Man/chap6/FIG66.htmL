<pre>
			GLOBAL ALL
			PROBLEM ROCKET(20000,2000,2000)
				DIMENSION SPI(3),SPIVAC(3),TBURN(3),THRUST(3),XIP(3),WPROP(3)
				DIMENSION  RATIO(3),WSTAGE(3),STRFAC(3),DELV(3), G(2)
				DATA THRUST /350,1500,4100/,TBURN/110,100,180/
				DATA  XIP/5E-3,0,0/,SPIVAC/3*315/
				FIND THRUST(1),THRUST(2),TBURN(2),TBURN(3); IN STAGES;
           &        BY HERA;  REPORTING DLVTOT,TBTOT; TO MINIMIZE WEIGHT
			END
			MODEL STAGE
				FIND THRUST(3), TBURN(1); IN EQS; BY AJAX; TO MATCH G
			END

			MODEL EQNS
C				THREE STAGE ROCKET PHENOMENA MODEL	
				DATA GC,WPAYLD,DELVIP,TBIP/32.174,50,2.8E4,400/
				DLVTOT=0 : TBTOT=0
				WEIGHT=WPAYLD
				DO I=1,3
					SPI(I)=SPIVAC(I)*(1-XIP(I))
					WPROP(I)=THRUST(I)*TBURN(I)/SPI(I)
					WSTAGE(I)=0.0234*THRUST(I)+WPROP(I)+1.255*WPROP(I)**0.704+4
					WEIGHT=WEIGHT+WSTAGE(I)
					RATIO(I)=WEIGHT/(WEIGHT-WPROP(I))
					DELV(I)=GC*SPI(I)*LOG(RATIO(I))
					DLVTOT=DLVTOT+DELV(I)
					TBTOT=TBTOT+TBURN(I)
				END DO
				G(1)=DLVTOT-DELVIP ! Total delta V constraint
				G(2)=TBTOT-TBIP    ! Total burn time constraint
		END
</pre>