<!DOCTYPE HTML PUBLIC "-//W4C//DTD HTML 4.2//EN">
<html>
<head>
   <title>Solver JANUS</title>
   <style>
       tr { vertical-align: top; }
   </style>
</head>
<body text="#000066">
<h1 align=center>Solver JANUS</h1>

<p>JANUS is a fourth order Adams-Moulton predictor-corrector method, 
employing a fourth order Runge-Kutta starting procedure.  The equations 
are integrated by the Runge-Kutta procedure until enough information 
has been accumulated to begin the predictor-corrector method, i.e., 
for three steps.  On the fourth step, the technique switches automatically 
to the Adams-Moulton method.</p>

<p>During the Runge-Kutta process, the differential equations are evaluated 
four times per step by executing the model four times. Once the Adams-Moulton 
procedure begins, the model is executed only two times per step, although 
the accuracy of the results is the same as for the Runge-Kutta steps.</p>

<p>JANUS cannot be "nested" within a calculus process which activates 
derivative evaluation; however, its model may include any calculus 
process except another integration involving JANUS.  For example, 
the differential equations may be implicit equations (see Section 
5.5.) or integro-differential equations using the definite integral 
functions (INTEGRAL, ROMBINT, etc.).</p>

<p>A major advantage of JANUS is that it employs an automatic procedure 
for varying the integration step in order to hold numerical error 
within prescribed limits.  When the controls associated with this 
procedure are properly set, the step size will be either increased 
or decreased in a manner which permits the largest possible step within 
defined error criteria.</p>

<A NAME="INITIATE" ID="INITIATE"><H2>JANUS INITIATE Statement</H2></A>

The INITIATE statement for JANUS takes the following form:

<blockquote>
<B>INITIATE JANUS</B> {<B>(</B><I>controller</I><B>)</B>}<B>;</B> 
{<B>WITH</B>}<B>FLAG</B> <I>signal</I><B>;</B>} <br>
<B>FOR</B> <I>model</I><B>;</B> <B>EQUATIONS</B> <I>ode/vars</I><B>; OF</B>
<I>ind-var</I><b>;</b> <B>STEP</B> <I>delta</I><B>; TO</B> <I>limit</I>
</blockquote>

<p>The meaning and form of the symbols: <I>controller</I>, <I>model</I>, 
<I>ode/vars</I>, <I>ind-var</I>, <I>delta</I>, and <I>limit </I>are 
identical to those described for integration processes in Sections 
1.3 and 2.2.1</p>

</p>The equations are identified by the <I>ode/vars</I> list which specifies 
the names used in the <I>model</I> to represent the state  variables 
and their derivatives.  This list has the form<br><BR>

&nbsp;&nbsp;&nbsp;&nbsp;<I> der/var,der/var,...</I><BR><BR>

where <I>der</I> identifies ordinary derivatives and <I>var</I> identifies 
the corresponding dependent variables. For more detailed description, 
see Section 2.2.1.</p>

<p>The scalar variable <I>signal</I> is set by JANUS to denote its action 
with respect to step size control.  After each INTEGRATE statement, 
JANUS sets <I>signal</I> as follows:</p>

<DIV STYLE=indented><hr>
<TABLE><TR><th>Value</th><th>Meaning</th></tr>                                                              
<tr><TD>0</TD><td>The step size was either increased or unchanged.</td></tr>

<tr><TD>n</TD><td>The step size was decreased because of excessive 
 		error in the nth ODE.</td></tr></table><hr>
</div>
<p>The equations are numbered by their sequence 
in the <I>ode/vars</I> list, not by their order of computation in 
the model.</p>

<p>The optional parenthesized phrase {<B>(</B><I>controller</I><B>)</B>} performs 
the usual function of identifying a controller so that control values 
may be changed for this use of JANUS.</p>

<p>The model must be a MODEL label, identifying the calculus model for 
this process.  This model must compute the ODEs and any auxiliary 
values which they require.  The MODEL may not have parameters, but 
may call other MODELs or FMODELs that do.</p>

<B><I>Executing JANUS</I></b>  -  Once the INITIATE statement has been executed, 
function generation is performed by JANUS whenever the statement

&nbsp;&nbsp;&nbsp;&nbsp;<B>INTEGRATE</B> <I>model</I><b>; BY JANUS</b><br><br>

is executed.  This statement generates the integral function up to 
the limit value of <I>ind-var</I>.</p> 

<p>This statement generates no printed output.  If the values at the 
end of a step are required, they must be printed by ordinary FORTRAN 
output statements.</p>

<H4>Example</H4>

<p>If the integration was initiated by</p>

<PRE>
      X = 0   : Y = 1 :  T = 0  :  DT = 0.01
      INITIATE JANUS; FOR DIFF; EQUATIONS  XDOT/X, YDOT/Y;
         OF T;  STEP DT; TO TF
</PRE>         

<p>then integration up to T = 1, with printing at .1,.2,.3,... may be 
performed by</p>

<PRE>
      TF = 0
      DO WHILE (TF.LT.1)
         TF=TF+.1 
         INTEGRATE DIFF; BY JANUS
      END DO
</PRE>

<p>If the values of any of the dependent variables or the independent 
variable are altered after the INITIATE statement, this imposes a 
discontinuity in the equations.  In fact, this really defines a new 
initial value problem.  While this is perfectly valid, it is mandatory 
that an INITIATE statement be executed once more before continuing 
integration.  This is necessary because the Adams-Moulton procedure 
maintains a "memory" of previous steps.  On the other hand, the step 
size may be modified at will between INTEGRATE statements.  (If this 
is done, JANUS will automatically reimpose its Runge-Kutta starting 
procedure in order to refresh its memory.)</p>

<A NAME="CONTROLS" ID="CONTROLS"><H2>JANUS Controls</H2></A>

<P>JANUS has four control variables, all 
associated with its automatic step size adjustment.  They are as follows:

<DIV STYLE="indented"><hr>
<TABLE>
<TR>
<TH ALIGN=LEFT>Variable</TH>
<TH ALIGN=LEFT>Description</TH>
<TH ALIGN=RIGHT>Preset Value</TH>
</TR>

<TR WIDTH=100%>
<TD VALIGN=TOP WIDTH=15%><B>ERRLO</B></TD>
<TD><b>Fractional error lower limit.</b><BR>
If the relative predictor-corrector errors (The relative error is the absolute error divided 
by the magnitude of the dependent variable.) for all equations are less than this value then 
the step size is doubled for use on the next step. The upper limit is STEPMAX.</TD>
<TD VALIGN=TOP>10<SUP>-7</SUP></TD>
</TR>

<TR WIDTH=100%>
<TD VALIGN=TOP><B>ERRHI</B></TD>
<TD><B>Fractional error upper limit</B><BR>
If any equation generates a relative error greater than this value, the step size is halved 
and the integration step is reexecuted at the lower value. This may occur repeatedly during 
one step if the resulting error is still too large. The lower limit is STEPMIN.</TD>
<TD VALIGN=TOP>10<SUP>-4</SUP></TD>		
</TR>                                                            

<TR WIDTH=100%>
<TD VALIGN=TOP><B>STEPMAX</B></TD>
<TD><B>Maximum step size.</B><BR>The preset value is effectively no limit.</TD>
<TD VALIGN=TOP>10<SUP>9</SUP></TD>	
</TR>

<TR WIDTH=100%>
<TD VALIGN=TOP><B>STEPMIN</B></TD>
<TD><B>Minimum step size</B><BR>The preset value allows the adjustment control 
to be effectively free to reduce the steps. If no real limit is imposed, it is desirable 
to test the step size periodically while integrating in order to see if it is decreasing 
unreasonably.  Often this is a good indication of a poorly posed problem.</TD>
<TD VALIGN=TOP>10<SUP>-9</SUP></TD>
</TR>

</TABLE><HR></DIV>		      								

  
